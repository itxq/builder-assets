$("form.builder-create-form").each(function(){let formId="#"+$(this).attr("id");let validateConfigFields=$(formId+"_validate_config").val();let redirectUrl=$(formId+"_redirect_url").val();createBootstrapValidator(formId,validateConfigFields,redirectUrl)});$(".js-tree-input").each(function(){let id=$(this).attr("id");let value=$(this).val();let data=$(this).attr("data-list");createJsTree(id,data,value)});$(".ckeditor-textarea").each(function(){let ckID=$(this).attr("id");let conId="#"+ckID+"_js_con";let uploadUrl=$(this).attr("data-upload");let apiUrl=$(this).attr("data-api");createCkeditor(ckID,conId,uploadUrl,apiUrl)});$(".select2-selectpicker").selectpicker("render");$(".daterangepicker-input").each(function(){let id="#"+$(this).attr("id");let startDate=$(this).attr("data-start-date");let endDateDate=$(this).attr("data-end-date");createDateRangepicker(id,startDate,endDateDate)});$(".qq-map-group").each(function(){let id=$(this).attr("id");qqMapInit("map-container-"+id,"map-address-"+id,"ma-location-"+id)});$(document).on("click",".map-toggle-btn",function(){$("#"+$(this).attr("data-container")).toggle(800)});$(".bootstrap-tagsinput-role").tagsinput({tagClass:function(a){return"btn btn-info btn-sm"}});$(".colorpicker-group-item").each(function(){let id="#"+$(this).attr("id");$(id).colorpicker({format:$(this).attr("data-format")})});$(document).on("click","form .form-reset-btn",function(){$(this).parents("form.builder-create-form").bootstrapValidator("resetForm")});$(document).on("click",".form-json-group .form-json-group-core .form-json-delete",function(){if($(this).parents(".form-json-item").siblings(".form-json-item").length>=1){$(this).parents(".form-json-item").remove()}});$(document).on("click",".form-json-group .form-json-group-add .form-json-add",function(){var a=$(this).parents(".form-json-group-add").siblings(".form-json-group-demo").html();a=a.replace(/disabled/ig,"");$(this).parents(".form-json-group-add").siblings(".form-json-group-core").append(a)});function addTrigger(b,e,a,d,f,c){$(document).ready(function(){if(d){var h=$('[name="'+b+'"]');var g=h.val();if(h.is("input")){g=$('[name="'+b+'"]:checked').val()}ajaxSelect(a,g,e,f,c)}});$(document).on("change",'[name="'+b+'"]',function(){var g=$(this).val();ajaxSelect(a,g,e,f,c)})}function ajaxSelect(b,e,d,f,c){var a={data:e};if(f&&f!==""&&f!==null){a=$("#"+f).serialize()}$.ajax({url:b,type:"GET",data:a,dataType:"json",success:function(l){var k="";if(l.code===1&&l.data!==null&&l.data!==""&&l.data.length>=1){var n=l.data;for(var j=0;j<n.length;j++){var m=n[j].value;var o=n[j].desc;var h=n[j].check;if(h==="true"){k+='<option value="'+m+'" selected="selected">'+o+"</option>"}else{k+='<option value="'+m+'">'+o+"</option>"}}}var g=$('select[name="'+d+'"]');g.html(k);if(c&&c!==""&&c!==null){$('select[name="'+c+'"]').trigger("change")}}})}function showOrHide(e,c,d){d=d.split(",");var b=$('[name="'+e+'"]');var a=b.val();$(document).ready(function(){if(b.is("input")){a=$('[name="'+e+'"]:checked').val()}checkShowOrHide(a,d,c)});$(document).on("change",'[name="'+e+'"]',function(){checkShowOrHide($(this).val(),d,c)})}function checkShowOrHide(e,d,c){var b=parseInt($.inArray(e,d));var a=$('[name="'+c+'"]');if(b===-1){a.attr("disabled","disabled");a.parents("div.form-group").hide()}else{a.removeAttr("disabled");a.parents("div.form-group").show()}}$(document).on("click",".password-input .password-controller",function(){var b=$(this).parent(".input-group-btn").siblings("input.form-control");var a=$(this);if(b.attr("type")==="password"){b.attr("type","text");a.html("隐藏")}else{b.attr("type","password");a.html("显示")}});$(document).on("click",".map-group .panel-heading",function(){if($(this).find(".panel-control i").hasClass("fa-chevron-up")){$(this).find(".panel-control i").removeClass("fa-chevron-up").addClass("fa-chevron-down")}else{$(this).find(".panel-control i").removeClass("fa-chevron-down").addClass("fa-chevron-up")}$(this).siblings(".group-sub").toggle()});function doAJaxCheckALL(g,a,d,c,f,h){let data=getCheckboxSon("son[]",h);if(data.length<1){alertNotify(a,"danger");return false}var e='<span class="text-light"><i class="fa fa-check"></i>&nbsp;确定</span>';var b='<span class="text-dark"><i class="fa fa fa-times"></i>&nbsp;取消</span>';layer.msg(g,{time:0,btn:[e,b],yes:function(i){layer.close(i);doAjax(d,"POST",data,c,f)}})}function getCheckboxSon(a,b){let data=[];let childBox;if(!b||b===""||b===null){childBox=$('input[name="'+a+'"]')}else{childBox=$("#"+b+' input[name="'+a+'"]')}childBox.each(function(){if($(this).is(":checked")){data.push($(this).val())}});return data}function doAjax(c,e,a,b,d){$.ajax({url:c,type:e,data:{data:a},dataType:"json",success:function(f){f.code=parseInt(f.code);if(f.code!==1){alertNotify(f.msg,"danger")}else{if(f.code===1&&b!=="false"){alertNotify(f.msg,"success");setTimeout(function(){window.location.href=b},2000)}else{if(f.code===1&&d==="true"){alertNotify(f.msg,"success");$("table").bootstrapTable("refresh")}else{alertNotify(f.msg,"success")}}}},error:function(f){alertNotify(f.msg,"danger");$(".ajax.ajax-action").removeClass("ajax-action")}})}function alertNotify(b,a){layer.msg(b)}function createBootstrapValidator(formId,validateConfigFields,redirectUrl){let validateConfig={};validateConfig.message="表单验证未通过";validateConfig.feedbackIcons={valid:"fa fa-check",invalid:"fa fa-times",validating:"fa fa-refresh"};validateConfig.fields=eval("("+validateConfigFields+")");$(formId).bootstrapValidator(validateConfig).on("success.form.bv",function(e){e.preventDefault();if(typeof CKEDITOR!=="undefined"){var ckeditorInstance;for(ckeditorInstance in CKEDITOR.instances){CKEDITOR.instances[ckeditorInstance].updateElement()}}if($(e.target).attr("action")===""||$(e.target).attr("action")===null){$(formId).bootstrapValidator("disableSubmitButtons",false);return false}$.ajax({url:$(e.target).attr("action"),type:$(e.target).attr("method"),data:$(e.target).serialize(),dataType:"json",success:function(re){if(re.code===1){$(formId)[0].reset();$(formId).bootstrapValidator("resetForm");alertNotify(re.msg,"success");if(re.url&&re.url!==""&&re.url!==null){redirectUrl=re.url}if(typeof redirectUrl!=="undefined"&&redirectUrl!==""&&redirectUrl!==null){setTimeout(function(){window.location.href=redirectUrl},1500)}}else{$(formId).bootstrapValidator("disableSubmitButtons",false);alertNotify(re.msg,"danger")}},error:function(){$(formId).bootstrapValidator("disableSubmitButtons",false);alertNotify("网络错误,请重试...","danger")}})})}function createDateRangepicker(c,a,b){let dateRangepickerConfig={locale:{opens:"left",drops:"down",format:"YYYY-MM-DD HH:mm:ss",separator:"~",applyLabel:"确定",cancelLabel:"取消",fromLabel:"起始时间",toLabel:"结束时间'",customRangeLabel:"自定义",weekLabel:"周",daysOfWeek:["日","一","二","三","四","五","六"],monthNames:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],firstDay:1},autoApply:true,timePicker:true,timePickerSeconds:true,timePickerIncrement:1,timePicker24Hour:true,alwaysShowCalendars:true,showWeekNumbers:true,showISOWeekNumbers:true,startDate:moment().startOf("day"),endDate:moment().startOf("day"),ranges:{"今日":[moment().startOf("day"),moment().endOf("day")],"昨日":[moment().startOf("day").subtract(1,"days"),moment().endOf("day").subtract(1,"days")],"最近7日":[moment().subtract(6,"days"),moment()],"最近30日":[moment().subtract(29,"days"),moment()],"本月":[moment().startOf("month"),moment().endOf("month")],"上月":[moment().subtract(1,"month").startOf("month"),moment().subtract(1,"month").endOf("month")]}};if(b!==""&&a!==""){dateRangepickerConfig.startDate=a;dateRangepickerConfig.endDate=b}$(c).daterangepicker(dateRangepickerConfig)}function createCkeditor(a,d,b,c){let config={skin:"moono-lisa",uiColor:"#FFFFFF"};let ck_finder_api_title="来自编辑器 CKEditor";let ck_finder_api_skin="neko";let ck_finder_api_swatch="b";let filebrowserBrowseUrl=b+"?ck_finder_api_title="+ck_finder_api_title+"&ck_finder_api_skin="+ck_finder_api_skin+"&ck_finder_api_swatch="+ck_finder_api_swatch+"&ck_finder_api_url="+c;if(c&&c!==""){config.filebrowserBrowseUrl=filebrowserBrowseUrl}CKEDITOR.replace(a,config).setData($(d).html())}function createJsTree(id,data,value){$("#tree_"+id).jstree({plugins:["checkbox","types","themes"],checkbox:{keep_selected_style:false,tie_selection:true,whole_node:true,three_state:false},types:{"default":{icon:"fa fa-file icon-state-warning icon-lg"},folder:{icon:"fa fa-folder icon-state-warning icon-lg"},file:{icon:"fa fa-file icon-state-warning icon-lg"}},core:{multiple:true,themes:{stripes:false,variant:"large",responsive:false,ellipsis:true},check_callback:true,data:eval("("+data+")")}}).on("loaded.jstree",function(e,data){let inst=data.instance;if(value!==""){let nodeList=value.split(",");$.each(nodeList,function(i,v){inst.select_node(inst.get_node(v))})}}).on("changed.jstree",function(e,data){let treeId="tree_"+id;let selectedIds=$("#"+treeId).jstree(true).get_selected(false);selectedIds=selectedIds.join(",");$("#"+id).val(selectedIds)})}function selectFileWithCKFinder(a,b){CKFinder.modal({displayFoldersPanel:false,skin:"neko",swatch:"b",connectorPath:b,chooseFiles:true,width:800,height:600,lugins:[],onInit:function(c){c.on("files:choose",function(d){var f=d.data.files.first();var e=document.getElementById(a);e.value=f.getUrl()});c.on("file:choose:resizedImage",function(d){var e=document.getElementById(a);e.value=d.data.resizedUrl})}})};